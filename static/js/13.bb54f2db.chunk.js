(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[13],{162:function(e,a,t){"use strict";t.r(a);var n=t(21),r=t(7),s=t(8),o=t(24),c=t(10),u=t(9),l=t(0),i=t.n(l),m=(t(89),t(19)),p=t(67),h=t(56),d=t(54),g=new(function(){function e(){Object(r.a)(this,e)}return Object(s.a)(e,[{key:"login",value:function(e,a){return h.a.post("/auth/login",{email:e,password:a}).then((function(e){return e.data&&d.a.setUser(e.data),e.data}))}},{key:"logout",value:function(){d.a.removeUser()}},{key:"register",value:function(e,a,t){return h.a.post("/auth/signup",{username:e,email:a,password:t})}},{key:"getCurrentUser",value:function(){return d.a.getUser()}}]),e}()),f=function(e){Object(c.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(r.a)(this,t),(n=a.call(this,e)).state={isToggleOn:!0},n.handleClick=n.handleClick.bind(Object(o.a)(n)),n.login=n.login.bind(Object(o.a)(n)),n.onChangeUsername=n.onChangeUsername.bind(Object(o.a)(n)),n.onChangePassword=n.onChangePassword.bind(Object(o.a)(n)),n.state={username:"",password:""},n}return Object(s.a)(t,[{key:"handleClick",value:function(){this.setState((function(e){return{isToggleOn:!e.isToggleOn}}))}},{key:"login",value:function(){var e=this;g.login(this.state.username,this.state.password).then((function(){e.props.history.push("/dashboard/default"),window.location.reload()}),(function(e){console.log(e)}))}},{key:"onChangeUsername",value:function(e){this.setState({username:e.target.value})}},{key:"onChangePassword",value:function(e){this.setState({password:e.target.value})}},{key:"render",value:function(){var e;return i.a.createElement(m.a,null,i.a.createElement(p.a,null),i.a.createElement("div",{className:"auth-wrapper "},i.a.createElement("div",{className:"auth-content"},i.a.createElement("div",{className:"auth-bg"},i.a.createElement("span",{className:"r"}),i.a.createElement("span",{className:"r s"}),i.a.createElement("span",{className:"r s"}),i.a.createElement("span",{className:"r"})),i.a.createElement("div",{className:"card"},i.a.createElement("div",{className:"card-body text-center"},i.a.createElement("div",{className:"mb-4"},i.a.createElement("i",{className:"feather icon-user-plus auth-icon"})),i.a.createElement("h3",{className:"mb-4"},"Buses Administraci\xf3n"),i.a.createElement("div",{className:"input-group mb-3"},i.a.createElement("input",{type:"text",className:"form-control",placeholder:"Username",name:"username",value:this.state.username,onChange:this.onChangeUsername})),i.a.createElement("div",{className:"input-group mb-4"},i.a.createElement("input",(e={type:"password",className:"form-control",placeholder:"password"},Object(n.a)(e,"type","password"),Object(n.a)(e,"className","form-control"),Object(n.a)(e,"name","password"),Object(n.a)(e,"value",this.state.password),Object(n.a)(e,"onChange",this.onChangePassword),e))),i.a.createElement("button",{className:"btn btn-secondary shadow-2 mb-4",onClick:this.login},"Iniciar Sesi\xf3n"))))))}}]),t}(i.a.Component);a.default=f},54:function(e,a,t){"use strict";var n=t(7),r=t(8),s=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"getLocalRefreshToken",value:function(){var e=JSON.parse(localStorage.getItem("user"));return null===e||void 0===e?void 0:e.refreshToken}},{key:"getLocalAccessToken",value:function(){var e=JSON.parse(localStorage.getItem("user"));return null===e||void 0===e?void 0:e.token}},{key:"updateLocalAccessToken",value:function(e){var a=JSON.parse(localStorage.getItem("user"));a.accessToken=e,localStorage.setItem("user",JSON.stringify(a))}},{key:"getUser",value:function(){return JSON.parse(localStorage.getItem("user"))}},{key:"setUser",value:function(e){console.log(JSON.stringify(e)),localStorage.setItem("user",JSON.stringify(e))}},{key:"removeUser",value:function(){localStorage.removeItem("user")}}]),e}();a.a=new s},56:function(e,a,t){"use strict";var n=t(68),r=t.n(n),s=t(69),o=t(70),c=t.n(o),u=t(54),l=c.a.create({baseURL:"https://appbus-backend.herokuapp.com/api",headers:{"Content-Type":"application/json"}});l.interceptors.request.use((function(e){var a=u.a.getLocalAccessToken();return a&&(e.headers["x-token"]=a),e}),(function(e){return Promise.reject(e)})),l.interceptors.response.use((function(e){return e}),function(){var e=Object(s.a)(r.a.mark((function e(a){var t,n,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("/auth/signin"===(t=a.config).url||!a.response){e.next=19;break}if(401!==a.response.status||t._retry){e.next=18;break}return t._retry=!0,e.prev=4,e.next=7,l.post("/auth/refreshtoken",{refreshToken:u.a.getLocalRefreshToken()});case 7:return n=e.sent,s=n.data.accessToken,u.a.updateLocalAccessToken(s),e.abrupt("return",l(t));case 13:return e.prev=13,e.t0=e.catch(4),e.abrupt("return",Promise.reject(e.t0));case 16:e.next=19;break;case 18:return e.abrupt("return",Promise.reject(a.response));case 19:return e.abrupt("return",Promise.reject(a));case 20:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(a){return e.apply(this,arguments)}}()),a.a=l}}]);
//# sourceMappingURL=13.bb54f2db.chunk.js.map