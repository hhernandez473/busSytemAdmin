(this["webpackJsonpdatta-able-rv18.0.4"]=this["webpackJsonpdatta-able-rv18.0.4"]||[]).push([[12],{148:function(e,t,a){"use strict";a.r(t);var n=a(21),r=a(2),c=a(15),l=a(7),i=a(8),s=a(10),o=a(9),u=a(0),d=a.n(u),m=a(143),h=a(98),p=a(150),f=a(144),E=a(160),g=a(137),v=a(53),b=a(61),S=(a(66),a(74),function(e){var t=e.data,a=e.headers,n=e.handleRemove,r=e.startEditing,c=e.editIdx,l=e.handleChange,i=e.stopEditing;return d.a.createElement("div",null,d.a.createElement("div",{className:"card "},d.a.createElement("table",{className:"table sizeTable "},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",{scope:"col"},"#"),a.map((function(e,t){return d.a.createElement("th",{key:"th-".concat(t),scope:"col"},e.name)})),d.a.createElement("th",{scope:"col"}),d.a.createElement("th",{scope:"col"}))),d.a.createElement("tbody",null,t.map((function(e,t){return function(e,t,a,n,r,c,l,i){var s=c===t;return d.a.createElement("tr",{key:"tr-".concat(t)},d.a.createElement("td",null,t),a.map((function(a,n){return d.a.createElement("td",{key:"td-".concat(n)},s?"driverAssigned"==a.prop?d.a.createElement(E.a.Control,{as:"select",name:"driverAssigned",onChange:function(e){return l(e,a.prop,t)}},e.userList.map((function(e,t){return d.a.createElement("option",{value:JSON.stringify(e),key:t}," ",e.name," ")}))):d.a.createElement("input",{type:"text",className:"form-control",onChange:function(e){return l(e,a.prop,t)},name:a.prop,value:e[a.prop]}):"driverAssigned"==a.prop?e[a.prop].name:e[a.prop])})),s?d.a.createElement("td",null,d.a.createElement("i",{className:"material-icons",onClick:function(){return i(t)}},"check_circle")):d.a.createElement("td",null,d.a.createElement("i",{className:"material-icons",onClick:function(){return r(t)}},"edit")),d.a.createElement("td",null,d.a.createElement("i",{className:"material-icons",onClick:function(){return n(t)}},"delete")))}(e,t,a,n,r,c,l,i)}))))))}),y=[{name:"Conductor",prop:"driverAssigned"},{name:"Hora de Salida",prop:"departureTime"},{name:"Hora de Retorno",prop:"returnTime"}],C=a(19),k=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={departureTime:"",returnTime:"",driverAssigned:"",userList:[],errors:""},e.validateFields=function(){var t=!1,a=[];return e.state.departureTime||(t=!0,a.push("La hora de salida es requerida")),e.state.returnTime||(t=!0,a.push("La hora de retorno es requerida")),t&&e.setState({errors:a}),t},e.handleInputChange=function(t){var a=t.target.value,r=t.target.name;e.setState(Object(n.a)({},r,"driverAssigned"==r?JSON.parse(a):a))},e.createRow=function(t){t.preventDefault();var a=e.state.name,n=e.state;e.validateFields()||(e.props.addRow(n),e.setState({departureTime:"",returnTime:"",driverAssigned:"",name:a,errors:""}),t.currentTarget.reset(),e.getUserList())},e.createSchedule=function(t){t.preventDefault();var a=e.state;t.currentTarget.reset(),e.getUserList(),console.log(a)},e.getUserList(),e}return Object(i.a)(a,[{key:"getUserList",value:function(){var e=this;v.a.get("/usuarios").then((function(t){e.setState({userList:t.data.users,driverAssigned:t.data.users[0]})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return d.a.createElement(d.a.Fragment,null,d.a.createElement(C.a,null,d.a.createElement(m.a,null,d.a.createElement(h.a,null,this.state.errors&&d.a.createElement("div",{className:"alert alert-warning",role:"alert"},this.state.errors.map((function(e){return d.a.createElement("li",null,e)}))),d.a.createElement("form",{onSubmit:this.createRow,autoComplete:"off"},d.a.createElement(m.a,null,d.a.createElement(h.a,null,d.a.createElement(E.a.Group,{as:m.a,controlId:"exampleForm.ControlSelect1"},d.a.createElement(E.a.Label,{column:!0,sm:"4"},"Conductores"),d.a.createElement(h.a,{sm:"8"},d.a.createElement(E.a.Control,{as:"select",name:"driverAssigned",onChange:this.handleInputChange},this.state.userList.map((function(e,t){return d.a.createElement("option",{value:JSON.stringify(e),key:t}," ",e.name," ")}))))))),d.a.createElement(m.a,null,d.a.createElement(h.a,{md:4},d.a.createElement("input",{type:"text",onChange:this.handleInputChange,className:"form-control",placeholder:"Hora salida",name:"departureTime"})),d.a.createElement(h.a,{md:4},d.a.createElement("input",{type:"text",onChange:this.handleInputChange,className:"form-control",placeholder:"Hora retorno",name:"returnTime"})),d.a.createElement(h.a,{md:4},d.a.createElement("button",{type:"submit",className:"btn-block btn btn-raised btn-primary"},"Agregar"))))))))}}]),a}(d.a.Component),L=function(e){Object(s.a)(a,e);var t=Object(o.a)(a);function a(){var e;return Object(l.a)(this,a),(e=t.call(this)).state={data:[],headers:y,editIdx:-1,userList2:[],routeList:[],scheduleList:[],btn:!1,scheduleId:0},e.addRow=function(t){var a=e.state.data,n=[].concat(Object(c.a)(a),[t]);e.setState({data:n})},e.handleRemove=function(t){e.setState({data:e.state.data.filter((function(e,a){return a!==t}))})},e.startEditing=function(t){e.setState({editIdx:t})},e.stopEditing=function(t){e.setState({editIdx:-1})},e.handleChange=function(t,a,c){var l=t.target.value;e.setState({data:e.state.data.map((function(e,t){return t===c?Object(r.a)(Object(r.a)({},e),{},Object(n.a)({},a,"driverAssigned"==a?JSON.parse(l):l)):e}))})},e.setRoute=function(t){var a=t.target.value;e.setState({route:a}),console.log(a)},e.createSchedule=function(){var t=e.state.route,a=e.state.data.map((function(e){return{departureTime:e.departureTime,returnTime:e.returnTime,driverAssigned:e.driverAssigned.uid}}));e.state.data.length>0&&e.state.data.find((function(e){return""!=e.name})).name,t||b.b.error("Seleccione ruta."),v.a.post("/schedule",{route:t,detail:a}).then((function(t){e.setState({data:[]}),b.b.success("Horario creado correctamente.")})).catch((function(e){b.b.error(e.data.msg)}))},e.editSchedules=function(t){var a=e.state.userList2,n=t.detail.map((function(e){return Object(r.a)(Object(r.a)({},e),{},{driverAssigned:Object(r.a)(Object(r.a)({},e.driverAssigned),{},{uid:e.driverAssigned._id}),userList:a,errors:""})}));e.setState({btn:!0,data:n,scheduleId:t._id}),console.log(n)},e.getdriverAssigned=function(t){return e.userList2.find((function(e){return e.uid=t}))},e.scheduleModify=function(){if(e.state.data.length<=0||e.state.scheduleId<=0)b.b.error("Ingrese horarios");else{var t=e.state.data.map((function(e){return{departureTime:e.departureTime,returnTime:e.returnTime,driverAssigned:e.driverAssigned.uid}}));v.a.put("/schedule/".concat(e.state.scheduleId),{detail:t}).then((function(t){e.cleanForm(),b.b.success("Horarios de bus modificados correctamente.")})).catch((function(e){b.b.error(JSON.stringify(e.data.errors,null,2))}))}},e.scheduleDel=function(t){v.a.del("/schedule/".concat(t._id)).then((function(t){e.cleanForm(),b.b.warning("Horario de bus eliminado correctamente.")})).catch((function(e){b.b.error(JSON.stringify(e.data.errors,null,2))}))},e.cleanForm=function(){e.setState({data:[],scheduleList:[],btn:!1}),e.getSchedules()},e.getRoutes(),e.getSchedules(),e.getUserList(),e}return Object(i.a)(a,[{key:"getRoutes",value:function(){var e=this;v.a.get("/route").then((function(t){e.setState({routeList:t.data.route}),e.setState({route:t.data.route[0]._id})})).catch((function(e){console.log(e)}))}},{key:"getSchedules",value:function(){var e=this;v.a.get("/schedule").then((function(t){e.setState({scheduleList:t.data.schedules})})).catch((function(e){console.log(e)}))}},{key:"getUserList",value:function(){var e=this;v.a.get("/usuarios").then((function(t){e.setState({userList2:t.data.users})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){var e=this;return d.a.createElement("div",{className:"container"},d.a.createElement(m.a,null,d.a.createElement(h.a,{md:12},d.a.createElement(p.a,null,d.a.createElement(p.a.Body,null,d.a.createElement(m.a,null,d.a.createElement(h.a,{md:12},d.a.createElement(f.a,{striped:!0,bordered:!0,hover:!0,size:"sm"},d.a.createElement("thead",null,d.a.createElement("tr",null,d.a.createElement("th",null,"#"),d.a.createElement("th",null,"Ruta"),d.a.createElement("th",null,"Editar"),d.a.createElement("th",null,"Eliminar"))),d.a.createElement("tbody",null,this.state.scheduleList.map((function(t,a){return d.a.createElement("tr",{key:a},d.a.createElement("td",{key:a+1},a+1),d.a.createElement("td",{key:t.id},t.route.name),d.a.createElement("td",null,d.a.createElement("i",{className:"material-icons btn btn-warning",onClick:function(){return e.editSchedules(t)}},"edit")),d.a.createElement("td",null,d.a.createElement("i",{className:"material-icons btn btn-danger",onClick:function(){return e.scheduleDel(t)}},"delete")))})))))),d.a.createElement(m.a,null,d.a.createElement(h.a,{md:6},d.a.createElement(E.a.Group,{as:m.a,controlId:"exampleForm.ControlSelect1"},d.a.createElement(E.a.Label,{column:!0,sm:"2"},"Ruta"),d.a.createElement(h.a,{sm:"10"},d.a.createElement(E.a.Control,{as:"select",name:"route",onChange:this.setRoute},this.state.routeList.map((function(e,t){var a=e._id,n=e.name;return d.a.createElement("option",{value:a,key:t}," ",n," ")})))))),d.a.createElement(h.a,{md:6},d.a.createElement(g.a,{variant:"success",onClick:this.createSchedule,disabled:this.state.btn|this.state.data.length<1},"Guardar"),d.a.createElement(g.a,{variant:"warning",onClick:this.scheduleModify,disabled:!this.state.btn},"Editar"),d.a.createElement(g.a,{variant:"secondary",onClick:this.cleanForm},"Limpiar"))),d.a.createElement("div",{className:"clearfix"}),d.a.createElement(m.a,null,d.a.createElement(h.a,{md:6},d.a.createElement(k,{addRow:this.addRow})),d.a.createElement(h.a,{md:6},d.a.createElement(S,{headers:y,data:this.state.data,handleRemove:this.handleRemove,startEditing:this.startEditing,editIdx:this.state.editIdx,handleChange:this.handleChange,stopEditing:this.stopEditing})))))),d.a.createElement(b.a,{closeButton:!1,position:"bottom-right"})))}}]),a}(d.a.Component);t.default=L},53:function(e,t,a){"use strict";var n=a(7),r=a(8),c=a(55),l=function(){function e(){Object(n.a)(this,e)}return Object(r.a)(e,[{key:"get",value:function(e){return c.a.get(e)}},{key:"post",value:function(e,t){return c.a.post(e,t)}},{key:"put",value:function(e,t){return c.a.put(e,t)}},{key:"del",value:function(e){return c.a.delete(e)}}]),e}();t.a=new l},74:function(e,t,a){}}]);
//# sourceMappingURL=12.581ae63b.chunk.js.map