{"version":3,"sources":["services/auth.service.js","Demo/Authentication/SignUp/SignUp1.js","services/token.service.js","services/api.js"],"names":["email","password","api","post","then","response","data","TokenService","setUser","removeUser","username","getUser","SignUp1","props","state","isToggleOn","handleClick","bind","login","onChangeUsername","onChangePassword","this","setState","prevState","AuthService","history","push","window","location","reload","error","console","log","e","target","value","Breadcrumb","className","type","placeholder","name","onChange","onClick","React","Component","user","JSON","parse","localStorage","getItem","refreshToken","token","accessToken","setItem","stringify","removeItem","instance","axios","create","baseURL","headers","interceptors","request","use","config","getLocalAccessToken","Promise","reject","res","err","a","originalConfig","url","status","_retry","getLocalRefreshToken","rs","updateLocalAccessToken"],"mappings":"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","file":"static/js/13.bb54f2db.chunk.js","sourcesContent":["import api from \"./api\";\r\nimport TokenService from \"./token.service\";\r\n\r\nclass AuthService {\r\n  login(email, password) {\r\n    return api\r\n      .post(\"/auth/login\", {\r\n        email,\r\n        password\r\n      })\r\n      .then(response => {\r\n        if (response.data) {\r\n          TokenService.setUser(response.data);\r\n        }\r\n\r\n        return response.data;\r\n      });\r\n  }\r\n\r\n  logout() {\r\n    TokenService.removeUser();\r\n  }\r\n\r\n  register(username, email, password) {\r\n    return api.post(\"/auth/signup\", {\r\n      username,\r\n      email,\r\n      password\r\n    });\r\n  }\r\n\r\n  getCurrentUser() {\r\n    return TokenService.getUser();\r\n  }\r\n}\r\n\r\nexport default new AuthService();","import React from 'react';\r\n\r\n\r\nimport './../../../assets/scss/style.scss';\r\nimport Aux from \"../../../hoc/_Aux\";\r\nimport Breadcrumb from \"../../../App/layout/AdminLayout/Breadcrumb\";\r\nimport AuthService from './../../../services/auth.service'\r\nclass SignUp1 extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.state = { isToggleOn: true };\r\n\r\n        // Este enlace es necesario para hacer que `this` funcione en el callback\r\n        this.handleClick = this.handleClick.bind(this);\r\n        this.login = this.login.bind(this);\r\n        this.onChangeUsername = this.onChangeUsername.bind(this);\r\n        this.onChangePassword = this.onChangePassword.bind(this);\r\n\r\n        this.state = {\r\n            username: \"\",\r\n            password: \"\",\r\n\r\n        };\r\n    }\r\n\r\n    handleClick() {\r\n        this.setState(prevState => ({\r\n            isToggleOn: !prevState.isToggleOn\r\n        }));\r\n    }\r\n\r\n    login() {\r\n        \r\n        \r\n        AuthService.login(this.state.username, this.state.password).then(\r\n            () => {\r\n                this.props.history.push(\"/dashboard/default\");\r\n                window.location.reload();\r\n            }, error => {\r\n                console.log(error);\r\n            }\r\n        )\r\n    }\r\n\r\n    onChangeUsername(e) {\r\n        this.setState({\r\n            username: e.target.value\r\n        });\r\n    }\r\n\r\n    onChangePassword(e) {\r\n        this.setState({\r\n            password: e.target.value\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Aux>\r\n                <Breadcrumb />\r\n                <div className=\"auth-wrapper \">\r\n                    <div className=\"auth-content\">\r\n                        <div className=\"auth-bg\">\r\n                            <span className=\"r\" />\r\n                            <span className=\"r s\" />\r\n                            <span className=\"r s\" />\r\n                            <span className=\"r\" />\r\n                        </div>\r\n                        <div className=\"card\">\r\n                            <div className=\"card-body text-center\">\r\n                                <div className=\"mb-4\">\r\n                                    <i className=\"feather icon-user-plus auth-icon\" />\r\n                                </div>\r\n                                <h3 className=\"mb-4\">Buses Administración</h3>\r\n                                <div className=\"input-group mb-3\">\r\n                                    <input type=\"text\" className=\"form-control\" placeholder=\"Username\" name=\"username\"\r\n                                        value={this.state.username}\r\n                                        onChange={this.onChangeUsername}\r\n                                        />\r\n                                </div>\r\n                                <div className=\"input-group mb-4\">\r\n                                    <input type=\"password\" className=\"form-control\" placeholder=\"password\" type=\"password\"\r\n                                        className=\"form-control\"\r\n                                        name=\"password\"\r\n                                        value={this.state.password}\r\n                                        onChange={this.onChangePassword}\r\n                                         />\r\n                                </div>\r\n\r\n                                <button className=\"btn btn-secondary shadow-2 mb-4\" onClick={this.login}>Iniciar Sesión</button>\r\n\r\n\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </Aux>\r\n        );\r\n    }\r\n}\r\n\r\nexport default SignUp1;","class TokenService {\r\n    getLocalRefreshToken() {\r\n      const user = JSON.parse(localStorage.getItem(\"user\"));\r\n      return user?.refreshToken;\r\n    }\r\n  \r\n    getLocalAccessToken() {\r\n      const user = JSON.parse(localStorage.getItem(\"user\"));\r\n      return user?.token;\r\n    }\r\n  \r\n    updateLocalAccessToken(token) {\r\n      let user = JSON.parse(localStorage.getItem(\"user\"));\r\n      user.accessToken = token;\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n    }\r\n  \r\n    getUser() {\r\n      return JSON.parse(localStorage.getItem(\"user\"));\r\n    }\r\n  \r\n    setUser(user) {\r\n      console.log(JSON.stringify(user));\r\n      localStorage.setItem(\"user\", JSON.stringify(user));\r\n    }\r\n  \r\n    removeUser() {\r\n      localStorage.removeItem(\"user\");\r\n    }\r\n  }\r\n  \r\n  export default new TokenService();","import axios from \"axios\";\r\nimport TokenService from \"./token.service\";\r\n\r\nconst instance = axios.create({\r\n  //baseURL: \"http://localhost:8080/api\",\r\n  baseURL: \"https://appbus-backend.herokuapp.com/api\",\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\ninstance.interceptors.request.use(\r\n  (config) => {\r\n    const token = TokenService.getLocalAccessToken();\r\n    if (token) {\r\n      // config.headers[\"Authorization\"] = 'Bearer ' + token;  // for Spring Boot back-end\r\n      config.headers[\"x-token\"] = token; // for Node.js Express back-end\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\ninstance.interceptors.response.use(\r\n  (res) => {\r\n    return res;\r\n  },\r\n  async (err) => {\r\n    const originalConfig = err.config;\r\n\r\n    if (originalConfig.url !== \"/auth/signin\" && err.response) {\r\n      // Access Token was expired\r\n      if (err.response.status === 401 && !originalConfig._retry) {\r\n        originalConfig._retry = true;\r\n\r\n        try {\r\n          const rs = await instance.post(\"/auth/refreshtoken\", {\r\n            refreshToken: TokenService.getLocalRefreshToken(),\r\n          });\r\n\r\n          const { accessToken } = rs.data;\r\n          TokenService.updateLocalAccessToken(accessToken);\r\n\r\n          return instance(originalConfig);\r\n        } catch (_error) {\r\n          return Promise.reject(_error);\r\n        }\r\n      }else {\r\n        \r\n       return Promise.reject(err.response);\r\n      }\r\n    }\r\n\r\n    return Promise.reject(err);\r\n  }\r\n);\r\n\r\nexport default instance;"],"sourceRoot":""}